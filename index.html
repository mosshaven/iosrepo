<!DOCTYPE html>
<html lang="ru">
<head>
    <title>slutvibe Repo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root { --main-yellow: #f1c40f; --dark-bg: #1a1a1a; }
        body { background: var(--dark-bg); color: #eee; font-family: -apple-system, sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { color: var(--main-yellow); font-size: 2.5em; text-transform: uppercase; letter-spacing: 2px; }
        .icon { width: 150px; height: 150px; border-radius: 30px; border: 4px solid var(--main-yellow); margin-bottom: 20px; }
        .btn { background: var(--main-yellow); color: black; padding: 15px 30px; border-radius: 50px; text-decoration: none; font-weight: bold; display: inline-block; margin: 10px; transition: 0.3s; }
        .btn:hover { transform: scale(1.05); background: #fff; }
        .contact { margin-top: 30px; font-size: 0.9em; opacity: 0.7; }
        .contact a { color: var(--main-yellow); text-decoration: none; }
        
        #tweak-list { text-align: left; background: #222; border-radius: 15px; padding: 10px; margin-top: 30px; border: 1px solid #333; }
        .tweak-item { padding: 10px; border-bottom: 1px solid #333; }
        .tweak-item:last-child { border-bottom: none; }
        .tweak-name { color: var(--main-yellow); font-weight: bold; display: block; }
        .tweak-desc { font-size: 0.85em; color: #aaa; }
    </style>
</head>
<body>
    <div class="container">
        <img src="CydiaIcon.png" alt="Icon" class="icon">
        
        <h1>slutvibe</h1>
        <p>Персональный репозиторий для iOS 12 и ниже</p>

        <a class="btn" href="sileo://source/https://fragmentmusic.xyz/">ДОБАВИТЬ В SILEO</a>

        <div id="tweak-list">
            <div style="text-align:center; padding: 10px;">Загрузка пакетов...</div>
        </div>

        <div class="contact">
            Разработчик: <a href="https://t.me/slutvibe">@slutvibe</a>
        </div>
    </div>

    <script>
        // Скрипт парсит файл Packages и группирует по категориям
        fetch('Packages')
            .then(response => response.text())
            .then(data => {
                const container = document.getElementById('tweak-list');
                container.innerHTML = '';
                
                const packages = data.split('\n\n');
                const categories = {};
                
                packages.forEach(pkg => {
                    const name = pkg.match(/^Name: (.*)$/m);
                    const desc = pkg.match(/^Description: (.*)$/m);
                    const vers = pkg.match(/^Version: (.*)$/m);
                    const sect = pkg.match(/^Section: (.*)$/m);
                    
                    if (name) {
                        const section = sect ? sect[1] : 'Other';
                        if (!categories[section]) {
                            categories[section] = [];
                        }
                        categories[section].push({
                            name: name[1],
                            desc: desc ? desc[1] : 'Описание отсутствует.',
                            version: vers ? vers[1] : ''
                        });
                    }
                });
                
                // Создаем секции для каждой категории
                const categoryNames = {
                    'App': 'Приложения',
                    'Tweaks': 'Твики',
                    'Other': 'Другое'
                };
                
                Object.keys(categories).forEach(category => {
                    if (categories[category].length > 0) {
                        const sectionDiv = document.createElement('div');
                        sectionDiv.innerHTML = `<h4 style="color:var(--main-yellow); margin-top:20px; text-align:left;">${categoryNames[category] || category}:</h4>`;
                        
                        categories[category].forEach(pkg => {
                            const item = document.createElement('div');
                            item.className = 'tweak-item';
                            item.innerHTML = `
                                <span class="tweak-name">${pkg.name} <small style="color:#666">(${pkg.version})</small></span>
                                <span class="tweak-desc">${pkg.desc}</span>
                            `;
                            sectionDiv.appendChild(item);
                        });
                        
                        container.appendChild(sectionDiv);
                    }
                });
                
                if (Object.keys(categories).length === 0) {
                    container.innerHTML = '<div style="text-align:center; padding: 10px;">Пакеты не найдены.</div>';
                }
            })
            .catch(err => {
                document.getElementById('tweak-list').innerHTML = '<div style="text-align:center; padding: 10px;">Не удалось загрузить пакеты.</div>';
            });
    </script>
</body>
</html>